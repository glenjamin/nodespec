<div class="document">
<div class="section" id="nodespec">
<h1>NodeSpec</h1>
<p>A light-weight <a class="reference external" href="http://relishapp.com/rspec">RSpec</a>-esque testing framework designed and built
specifically for NodeJS.</p>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><a class="reference internal" href="#features" id="id1">Features</a></li>
<li><a class="reference internal" href="#development" id="id2">Development</a></li>
<li><a class="reference internal" href="#installation" id="id3">Installation</a></li>
<li><a class="reference internal" href="#usage" id="id4">Usage</a></li>
<li><a class="reference internal" href="#copyright" id="id5">Copyright</a></li>
</ul>
</div>
<div class="section" id="features">
<h2><a class="toc-backref" href="#id1">Features</a></h2>
<blockquote>
<ul class="simple">
<li>Ground-up support for NodeJS convention callbacks</li>
<li>Only one test running at a time</li>
<li><strong>No global variables</strong></li>
<li>RSpec style syntactic sugar<ul>
<li>Nested contexts <strong>(not yet implemented)</strong></li>
<li>Easy to use setup/teardown</li>
<li>Subject helpers <strong>(not yet implemented)</strong></li>
</ul>
</li>
<li>Pluggable mocking support <strong>(not yet implemented)</strong></li>
<li>Native assertions</li>
<li>Easy to extend or replace the default assertions <strong>(not yet implemented)</strong></li>
<li>Multiple output formatters on the same test run <strong>(not yet implemented)</strong></li>
</ul>
</blockquote>
</div>
<div class="section" id="development">
<h2><a class="toc-backref" href="#id2">Development</a></h2>
<dl class="docutils">
<dt><a class="reference external" href="http://tom.preston-werner.com/2010/08/23/readme-driven-development.html">README Driven Development</a></dt>
<dd>Any and all features will be outlined in this readme file <em>before</em> the tests
are written.</dd>
<dt>BEHAVIOUR Driven Development</dt>
<dd>Integration tests which treat the executable as a black-box will be written
using <a class="reference external" href="http://cukes.info/">cucumber</a> &amp; <a class="reference external" href="https://github.com/cucumber/aruba">aruba</a> (yes, using Ruby)
before any implementation.</dd>
<dt>Lots and lots of Unit Tests</dt>
<dd>All code will be fully unit tested using NodeSpec itself before release.</dd>
</dl>
<p>If you'd like to contribute</p>
<blockquote>
<ol class="arabic simple">
<li>Fork the repository on github</li>
<li>Make your changes</li>
<li>Run the unit tests</li>
<li>Run the cucumber tests with <cite>cucumber -p all</cite></li>
<li>Push back to github and send me a pull request</li>
</ol>
</blockquote>
<p>If you're fixing a bug, please add a testcase to prove it was broken and is fixed,
if you're adding a new feature, please add cucumber feature file for it.</p>
<p>To be able to run cucumber, you'll need Ruby and Bundler installed, then do <cite>bundle install</cite>.</p>
</div>
<div class="section" id="installation">
<h2><a class="toc-backref" href="#id3">Installation</a></h2>
<p>Until there's something worth using, I won't be publishing to npm.</p>
<p>For the moment just install via github tarball:</p>
<pre class="literal-block">
npm install https://github.com/glenjamin/nodespec/tarball/master
</pre>
<p>Or clone directly from github:</p>
<pre class="literal-block">
git clone git://github.com/glenjamin/nodespec
cd nodespec
npm link
</pre>
</div>
<div class="section" id="usage">
<h2><a class="toc-backref" href="#id4">Usage</a></h2>
<p>Require the module into test files to use it:</p>
<pre class="literal-block">
var nodespec = require('nodespec');
</pre>
<p>And then at the end of each test file:</p>
<pre class="literal-block">
nodespec.exec();
</pre>
<p>Simple spec:</p>
<pre class="literal-block">
nodespec.describe(&quot;Addition&quot;, function() {
    this.example(&quot;1 + 1 = 2&quot;, function() {
        this.assert.equal(1 + 1, 2);
        // Return non-undefined to indicate not async
        return true;
    });
});
</pre>
<p>Simple async spec:</p>
<pre class="literal-block">
nodespec.describe(&quot;nextTick&quot;, function() {
    this.example(&quot;fires the callback&quot;, function(test) {
        this.expect(2);
        this.assert.strictEqual(this, test);
        process.nextTick(function() {
            this.assert.strictNotEqual(this, test);
            test.done();
        });
    });
});
</pre>
<p>Before/After Hooks:</p>
<pre class="literal-block">
// Hooks share `this` with tests, but it's rebuilt each time
nodespec.describe(&quot;Some databasey test&quot;, function() {
    this.before(function(hook) {
        this.assert.strictEqual(this, hook);
        db_connect(function (err, conn) {
            hook.db = conn;
            hook.db.start_transaction(function(err, tx) {
                hook.tx = tx;
                hook.done();
            });
        });
    });
    this.after(function() {
        this.tx.rollback();
        return true; // not async
    });
    this.example(&quot;database interaction&quot;, function(test) {
        test.expect(2);
        test.db.insert({field: 1}, function(err, result) {
            test.assert.strictEqual(result.affected, 1);
            test.db.get(function(err, result) {
                test.assert.strictEqual(result.field, 1);
                test.done();
            });
        });
    });
});
</pre>
<p>Nested contexts with subject:</p>
<pre class="literal-block">
nodespec.describe(&quot;My Server&quot;, function() {
    // This function is executed once when `this.server` is accessed
    this.subject('server', function() {
        return new Server(1337);
    });
    this.context(&quot;Strict Mode&quot;, function() {
        this.before(function() {
            this.server.use_strict_mode();
            this.done();
        });
        this.example(&quot;invalid request fails&quot;, function(test) {
            test.expect(1);
            test.server.request('invalid', function(err, result) {
                test.assert.notEqual(err, null);
                test.done();
            });
        });
    });
    this.context(&quot;Not Strict Mode&quot;, function() {
        this.before(function() {
            this.server.dont_use_strict_mode();
            this.done();
        });
        this.example(&quot;invalid request fails silently&quot;, function(test) {
            test.expect(2);
            test.server.request('invalid', function(err, result) {
                test.assert.equal(err, null);
                test.assert.equal(result, null);
                test.done();
            });
        });
    });
});
</pre>
</div>
<div class="section" id="copyright">
<h2><a class="toc-backref" href="#id5">Copyright</a></h2>
<p>Copyright Â© 2011 The NodeSpec Authors. See LICENSE and AUTHORS for details.</p>
</div>
</div>
</div>

